---
title: "Week 2. Introduction to the tools: R, RStudio, RMarkdown. Reports"
output: 
  learnr::tutorial:
progressive: true
allow_skip: true
runtime: shiny_prerendered
---

Introduction to the tools: R, RStudio, RMarkdown. Reports + индексирование + базовые функции


Анализ данных (методы, которые можно применить, графики, которые можно построить) зависит от того, какие данные мы изучаем

### Типы данных

```{r echo=F}
library(DiagrammeR)
mermaid("
 graph LR
         D[Data]-->C[Categorical]
         D-->N[Numerical]
         C-->Nominal 
         C-->Or[Ordinal]
         N-->di[Discrete] 
         N-->co[Continuous]
")
```
     
**Примеры для обсуждения:**

- рост
- число студентов в классе
- страна проживания
- пол
- год создания
- цена
- удовлетворенность услугой (по шкале от 1 до 5)
- ...

### "Основные" типы данных в R

- numeric
- integer
- factor
- logical
- character

Для любой переменной можно проверить, к какому типу данных (классу) она относится:

```{r}
class(100)
class("Hello")
class(45.7)
class(TRUE)
class(1:2)
```

Можно проверить принадлежность к конкретному типу

```{r}
is.integer("Hello")
is.character("Hello")
is.integer(100)
is.numeric(100)
is.logical(45.7)
is.logical(TRUE)
```

... и преобразовать из типа в тип (но аккуратно)

```{r}
as.character(45.7)
as.character(100)
as.integer("Hello")
as.integer(100)
as.numeric(TRUE)
```

**Ваша очередь:** что получится в результате выполнения следующих команд?

```{r eval = FALSE}
class("Пример")
class(17)
class("17")
as.character(87.9)
is.integer("1")
as.integer(4.5)
as.numeric(FALSE)
```

### Создание переменной

Для создания переменных используется оператор присваивания `<-` или `=` (`a <- 6`). Т.е. мы придумываем имя переменной, а затем присваиваем ей некоторое значение. Дальше мы можем работать с этим именем

```{r}
newVariable <- TRUE
class(newVariable)
newVariable <- as.numeric(newVariable)
newVariable
newVariable + 7
```

Но анализ данных подразумевает работу со многими значениями. Так и переменная может соответствовать более сложным структурам

### Вектора 

Вектора считаются базовыми элементами в R. Они объединяют в себе несколько однотипных значений (например, возраст для целой группы, а не возраст одного человека), что позволяет, в частности, обрабатывать их все одновременно. Оператор `c()` используется для объединения нескольких элементов в один вектор

```{r}
age <- c(23, 20, 21, 19, 20, 21, 20, 23)
age
class(age)

## сколько будет лет каждому в группе через 5 лет
age + 5

## участнику группы 21 год?
age == 21
```

**Логические операции**

```{r}
## участнику группы 21 год? age <- c(23, 20, 21, 19, 20, 21, 20, 23)
age == 21

## участнику группы больше 21 года? age <- c(23, 20, 21, 19, 20, 21, 20, 23)
age > 21

## участнику группы не меньше 21 года? age <- c(23, 20, 21, 19, 20, 21, 20, 23)
age >= 21

## участнику группы не 20 лет? age <- c(23, 20, 21, 19, 20, 21, 20, 23)
age != 20

## участнику группы от 20 до 22? age <- c(23, 20, 21, 19, 20, 21, 20, 23)
(age >= 20) & (age <= 22)

```

**Обобщения**

О том, как работают разные функции, можно узнать из справки
```{r eval = F}
?min
?mean
?summary
?sum
```

Пример:

```{r}
min(age)
max(age)
mean(age)
summary(age)
```

Вектора могут быть не только числовыми, но и строковыми, логическими

```{r}
sex <- c("m", "m", "f", "f", "m", "f", "m", "f")
class(sex)
```

Если переменная принимает всего несколько значений, то она, скорее всего, соответствует некоторым категориям. В R категории представлены факторами (factors)

```{r}
sex <- as.factor(sex)
class(sex)
summary(sex)

## сравните с той же функцмей для age
summary(age)
```

### Таблицы данных (data frame)

Однако, мы редко имеем дело только с одной переменной, чаще для одного человека/предмета/страны... у нас есть несколько показателей (не только возраст, но и, например, пол). Т.е. данные можно объединять в таблицы (составляющие их вектора должны быть одинаковой длины)

```{r}
dataExample <- data.frame(age, sex)
class(dataExample)
dataExample

head(dataExample)
tail(dataExample)
```

Более содержательный пример: характеристики 38 популярных моделей автомобилей с 1999 по 2008 гг.

```{r message=F, warning=FALSE}
library(ggplot2)
head(mpg)
```

```{r eval = F}
?mpg
```

Типы данных некоторых переменных (с помощью символа $ можно указать, какая именно переменная нас интересует)

```{r}
class(mpg$displ)
class(mpg$year)
class(mpg$manufacturer)
```

Характеристики данных

```{r}
dim(mpg)
str(mpg)
summary(mpg)
```

## Ваша очередь:

Рассмотрим данные про ирисы

```{r eval = F}
?iris
data(iris)
```

* О чем эти данные?
* Сколько наблюдений и сколько переменных в данных?
* Какого типа данные?
* Каковы минимальные и максимальные значения переменных?




look at the contents of a data frame or tibble
open a help page that describes a data frame or tibble
identify the variables and their types in a tibble



В этом уроке мы повторим все, что узнали о типах переменных используемых в R, научимся различать операторы и применять базовые функции.



ВНИМАНИЕ:  при выполнении заданий на код, игнорируйте значения sample input и output



Типы переменных в R: http://www.tutorialspoint.com/r/r_data_types.htm

Операторы: http://www.statmethods.net/management/operators.html

Несколько полезных функций: http://www.statmethods.net/management/functions.html

Какие из следующих утверждений верны?
 Таблица данных (data frame) - это таблица состоящая из нескольких векторов одинаковой длины.
 Вектор - это набор данных одного типа
 R чувствительный к регистру символов. х и Х - это два разных объекта
 R не работает с логическими переменными
 R работает с текстовыми объектами (character type)
 Матрица - это трехмерный набор элементов одного типа
 В R можно работать со многими типами данных, включая векторы, матрицы и листы
Submit



Какие из следующих элементов, относятся к базовым типам данных в R (выберите все подходящие варианты) 
 логические (logical)
 факторные (factor)
 целые (integer)
 листы (list)
 символьные (character)
 матрица (matrix)
 числовые (numeric)
 таблицы данных (dataframe)
 
 Какое из выражений ниже используется для обозначения оператора И?

 !=
 &
 $
 <-
 |


Предположим, что у нас есть вектор x.

x <- c(2, 4, 5)
Для дальнейших преобразований нам нужно убедиться, что этот вектор - численный. Какая функция для этого пригодится?
 is.numeric(x)
 as.numeric(x)
 as.vector(x)


У нас есть числовой вектор y, состоящий из четырех элементов. 
y <- c(2, 4, 5, 6)
 
Создайте вектор такой же длины, но с логическими значениями.



Что мы можем делать с векторами? Например, мы можем их сложить.

Создадим два числовых вектора:

x <- c(2, 4, 5)
y <- c(1, 9, 6)
Сложите два вектора и сохраните новые значения в переменной z.




Есть два основных способа того, как можно присваивать имена векторам: 

1) Непосредственно при создании векторов 

> v <- c(x = 1.0, y = 2.5, z = -0.1)
> v
   x    y    z 
 1.0  2.5 -0.1 


2) Присвоить имена уже имеющимся векторам

> u <- c(1.0, -0.5, -0.5)
> names(u) <- c("x", "y", "z")
> u
   x    y    z 
 1.0 -0.5 -0.5 


А как можно поменять название одного вектора (столбца) в таблице данных с помощью функции names()? В векторе u измените название третьего объекта с z на i.



Мы загрузили данные о скорости для 50-ти автомобилей и о дистанциях, необходимых для торможения. Данные были собраны в 1920-х года.

Давайте посмотрим на первые записи в таблице.

> head(cars, 5)
  speed dist
1     4    2
2     4   10
3     7    4
4     7   22
5     8   16

Используйте функцию mean() чтобы найти среднюю скорость машин в 20-х годах. Для этого вам понадобится колонка 'speed' в датафрейме 'cars'. Не забудьте о символе $ когда обращаетесь к переменной speed.
Больше информации о данных и о том, как их можно загрузить в RStudio можно найти здесь: https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/cars.html

