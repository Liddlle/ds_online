---
title: "test"
output: 
learnr::tutorial: default
html_document: 
number_sections: no
toc: no
runtime: shiny_prerendered
---


```{r include=FALSE}
library(learnr)
library(checkr)
library(tidyverse)
library(datasets)
knitr::opts_chunk$set(exercise.checker = checkr::checkr_tutor)
```


```{r exe22-setup, echo = FALSE}
library(ggplot2)
data(mpg)
```

```{r exe22, exercise = TRUE, exercise.setup = "exe22-setup", exercise.eval = FALSE}
ggplot() +
  geom_histogram(data = mpg, aes(x = cty), binwidth = 1, fill="#008080", col="#483D8B", alpha = 0.5)  + 
  ggtitle("Распределение количества миль на один галон топлива\nв условиях города") + 
  xlab("Мили") + 
  ylab("Количество") +
  geom_vline(aes(xintercept = mean(mpg$cty)), linetype="dashed", color="#8B0000", size=1) +
  geom_vline(aes(xintercept = median(mpg$cty))) + 
  theme_bw()

```
```{r exe22-check, echo = FALSE}
test_1 <- find_statement("aes(x = cty)", "variable 'cty' goes on the x axis")
test_2 <- find_call("geom_vline()", "include 'geom_vline()'")
test_3 <- find_call("geom_histogram()", "include a 'geom_histogram()' layer")
test_4 <- find_statement("mpg") 
test_5 <- find_statement("median(whatever)", "you didn't use median()")


USER_CODE %>% test_1 %>% test_2 %>% test_3 %>% test_4 %>% test_5

```


flData = nycflights13::flights
flData = na.omit(flData)

flData = filter(flData, month == 6 | month == 7 | month == 8)
flData = filter(flData, dest == "MIA")
flData = arrange(flData, year, month, day)
flData = arrange(flData, desc(dep_delay))
flData = dplyr::select(flData, tail_num = tailnum, dep_delay:arr_delay)
flData = dplyr::select(flData, -arr_time)
flData = mutate(flData, dep_arr_dif = arr_delay - dep_delay)
flData = group_by(flData, tail_num)
tail_dif = dplyr::summarise(flData, median_dif = median(dep_arr_dif))
flData = inner_join(x = flData, y = tail_dif, by = "tail_num")

flData = arrange(flData, median_dif)
